<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join Helmet Heads - Youth Cycling Program</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Join Helmet Heads - A 501(c)(3) nonprofit empowering South Carolina teenagers with bikes, community, and the freedom to explore.">
    <link rel="canonical" href="https://helmetheads.club/qr">
    
    <!-- Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <link rel="stylesheet" href="styles.css?v=20251009">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"></noscript>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8FP0VQ2LC7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-8FP0VQ2LC7');
    </script>

    <!-- Microsoft Clarity tag -->
    <script type="text/javascript">
        window.addEventListener('load', function() {
            (function(c,l,a,r,i,t,y){
                c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
                t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
                y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
            })(window, document, "clarity", "script", "tn23wxt1i5");
        });
    </script>

    <!-- Meta Pixel (Facebook Ads) -->
    <script>
        window.addEventListener('load', function() {
            !function(f,b,e,v,n,t,s)
            {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};
            if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
            n.queue=[];t=b.createElement(e);t.async=!0;
            t.src=v;s=b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t,s)}(window, document,'script',
            'https://connect.facebook.net/en_US/fbevents.js');
            fbq('init', '828248643075397');
            fbq('track', 'PageView');
        });
    </script>
    <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=828248643075397&ev=PageView&noscript=1" /></noscript>
    
    <!-- QR Landing Page Styles -->
    <style>
        .qr-page {
            min-height: 100vh;
            background: var(--light-color);
            padding: 1rem 0;
        }
        
        .qr-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .qr-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
        }
        
        .qr-logo {
            width: 50px;
            height: auto;
        }
        
        .qr-brand-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 0;
        }
        
        .qr-title {
            display: none;
        }
        
        .qr-subtitle {
            display: none;
        }
        
        /* Personalized pitch section */
        .qr-pitch {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--dark-color);
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .qr-pitch p {
            margin-bottom: 0.75rem;
        }
        
        .qr-pitch p:last-child {
            margin-bottom: 0;
        }
        
        .qr-cta {
            font-size: 1rem;
            line-height: 1.5;
            color: var(--dark-color);
            text-align: center;
            margin-bottom: 1.5rem;
            font-weight: 500;
        }
        
        /* Main content area for side-by-side layout on desktop */
        .qr-content-wrapper {
            display: flex;
            gap: 2rem;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .qr-video-column {
            flex: 1;
        }
        
        .qr-signup-column {
            flex: 1;
        }
        
        /* Email signup widget - subtle background */
        .qr-widget-section {
            margin-bottom: 1rem;
            background: rgba(244, 237, 227, 0.3);
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        /* Constrain GiveButter widget */
        .qr-widget-section givebutter-widget {
            display: block;
            max-width: 100%;
            width: 100%;
        }
        
        .qr-widget-section givebutter-widget iframe,
        .qr-widget-section givebutter-widget > div,
        .qr-widget-section givebutter-widget [class*="widget"],
        .qr-widget-section givebutter-widget [class*="container"],
        .qr-widget-section givebutter-widget [class*="wrapper"] {
            max-width: 100% !important;
            width: 100% !important;
            box-sizing: border-box !important;
        }
        
        /* Video section with custom play button */
        .qr-video-container {
            margin-bottom: 0;
            position: relative;
        }
        
        .video-wrapper {
            position: relative;
            cursor: pointer;
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        .qr-video {
            width: 100%;
            display: block;
            border-radius: var(--border-radius);
        }
        
        .video-play-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.4);
            transition: opacity 0.3s ease;
        }
        
        .video-play-overlay:hover {
            background: rgba(0, 0, 0, 0.5);
        }
        
        .video-play-overlay.hidden {
            display: none;
        }
        
        .play-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(113, 22, 28, 0.4);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            animation: pulse 2s ease-in-out infinite;
        }
        
        .video-play-overlay:hover .play-button {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(113, 22, 28, 0.5);
        }
        
        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 4px 20px rgba(113, 22, 28, 0.4);
            }
            50% {
                box-shadow: 0 4px 30px rgba(113, 22, 28, 0.6);
            }
        }
        
        .play-button i {
            color: var(--white);
            font-size: 2rem;
            margin-left: 5px;
        }
        
        .play-message {
            color: var(--white);
            text-align: center;
            margin-top: 1rem;
            font-size: 0.9rem;
            font-weight: 500;
            max-width: 300px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        /* Thank you message */
        .qr-thank-you {
            display: none;
            background: var(--gradient);
            color: var(--white);
            padding: 1.25rem;
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .qr-thank-you.show {
            display: block;
        }
        
        .qr-thank-you i {
            font-size: 2rem;
            margin-bottom: 0.75rem;
            display: block;
        }
        
        .qr-thank-you h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--white);
        }
        
        .qr-thank-you p {
            color: rgba(255, 255, 255, 0.95);
            margin: 0;
            font-size: 0.95rem;
        }
        
        /* Donation section (hidden until after signup) */
        .qr-donation-section {
            display: none;
        }
        
        .qr-donation-section.show {
            display: block;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .qr-page {
                padding: 0.75rem 0;
            }
            
            .qr-container {
                padding: 0 15px;
            }
            
            .qr-header {
                margin-bottom: 1rem;
                gap: 0.5rem;
            }
            
            .qr-logo {
                width: 45px;
            }
            
            .qr-brand-name {
                font-size: 1.25rem;
            }
            
            .qr-content-wrapper {
                flex-direction: column;
                gap: 1rem;
            }
            
            .qr-pitch {
                font-size: 0.95rem;
                margin-bottom: 1rem;
            }
            
            .qr-cta {
                font-size: 0.95rem;
            }
            
            .qr-widget-section {
                padding: 1rem;
            }
            
            .play-button {
                width: 70px;
                height: 70px;
            }
            
            .play-button i {
                font-size: 1.75rem;
            }
            
            .play-message {
                font-size: 0.85rem;
                max-width: 250px;
            }
            
            .qr-video-container {
                margin-bottom: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .qr-brand-name {
                font-size: 1.1rem;
            }
            
            .qr-pitch {
                font-size: 0.9rem;
            }
            
            .qr-cta {
                font-size: 0.9rem;
            }
            
            .play-button {
                width: 60px;
                height: 60px;
            }
            
            .play-button i {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <div class="qr-page">
        <div class="qr-container">
            <!-- Header with logo and brand name -->
            <div class="qr-header">
                <img src="logo.svg" alt="Helmet Heads Logo" class="qr-logo">
                <h1 class="qr-brand-name">Helmet Heads</h1>
            </div>

            <!-- Personalized Pitch (dynamically updated by JavaScript) -->
            <div class="qr-pitch" id="personalized-pitch">
                <p><strong id="greeting-text">Welcome!</strong> Helmet Heads is a 501(c)(3) nonprofit empowering South Carolina teenagers with bikes, community, and the freedom to explore through teacher-led cycling clubs.</p>
                <p>We've successfully raised initial funds and delivered bikes to students at BCHS in Cayce, but we want to raise more to help additional kids join the club and expand to other schools across South Carolina.</p>
            </div>

            <!-- Call to Action -->
            <p class="qr-cta">If you're interested in our mission, please sign up below - it really helps us out!</p>

            <!-- Thank You Message (hidden initially) -->
            <div class="qr-thank-you" id="thank-you-message">
                <i class="fas fa-check-circle"></i>
                <h3>Thank You!</h3>
                <p>We've added you to our mailing list. If you're able, please consider making a donation below.</p>
            </div>

            <!-- Content wrapper for side-by-side layout on desktop -->
            <div class="qr-content-wrapper">
                <!-- Video Column -->
                <div class="qr-video-column">
                    <div class="qr-video-container">
                        <div class="video-wrapper" id="video-wrapper">
                            <video class="qr-video" id="pitch-video" poster="helmetheads-elevator-pitch-still.avif" preload="metadata">
                                <source src="helmetheads-elevator-pitch.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <div class="video-play-overlay" id="video-overlay">
                                <div class="play-button">
                                    <i class="fas fa-play"></i>
                                </div>
                                <p class="play-message">Watch to learn what we do<br>(30 sec, has captions)</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Signup Column -->
                <div class="qr-signup-column">
                    <!-- Email Signup Widget -->
                    <div class="qr-widget-section" id="signup-section">
                        <givebutter-widget id="j2GvyL"></givebutter-widget>
                    </div>
                </div>
            </div>

            <!-- Donation Widget (hidden initially, shown after email signup) -->
            <div class="qr-widget-section qr-donation-section" id="donation-section">
                <givebutter-widget id="prm4Gg"></givebutter-widget>
            </div>
        </div>
    </div>

    <script src="script.js?v=20251009"></script>
    <script defer src="https://widgets.givebutter.com/latest.umd.cjs?acct=SqUcaiaJOyN4QAIZ&p=other"></script>
    
    <!-- QR Landing Page Script -->
    <script>
        // Location-based personalization mapping
        const locationGreetings = {
            '1': 'Thanks for scanning our business card!',
            '2': 'Hello from Cola Town Bike Collective!',
            '3': 'Thanks for scanning, fellow Indah Coffee lover!',
            'default': 'Welcome!'
        };

        // Parse location parameter from URL
        function getLocationParam() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('loc') || 'unknown';
        }

        // Set personalized greeting based on location
        function setPersonalizedGreeting() {
            const locationId = getLocationParam();
            const greetingText = document.getElementById('greeting-text');
            
            if (greetingText) {
                const greeting = locationGreetings[locationId] || locationGreetings['default'];
                greetingText.textContent = greeting;
            }
        }

        // Custom video play button functionality
        function initializeVideoPlayer() {
            const video = document.getElementById('pitch-video');
            const overlay = document.getElementById('video-overlay');
            const wrapper = document.getElementById('video-wrapper');
            
            if (!video || !overlay || !wrapper) return;
            
            // Click handler for play button
            wrapper.addEventListener('click', function() {
                if (video.paused) {
                    video.play();
                    overlay.classList.add('hidden');
                    video.setAttribute('controls', 'controls');
                }
            });
            
            // Show overlay again if video is paused
            video.addEventListener('pause', function() {
                if (video.currentTime < video.duration - 0.5) {
                    overlay.classList.remove('hidden');
                }
            });
            
            // Hide overlay when video ends
            video.addEventListener('ended', function() {
                overlay.classList.remove('hidden');
                video.removeAttribute('controls');
            });
        }

        // Track page view with location
        document.addEventListener('DOMContentLoaded', function() {
            const locationId = getLocationParam();
            
            // Set personalized greeting
            setPersonalizedGreeting();
            
            // Initialize video player
            initializeVideoPlayer();
            
            // Track in Google Analytics
            if (typeof gtag !== 'undefined') {
                gtag('event', 'qr_scan', {
                    'event_category': 'QR Code',
                    'event_label': 'Location ' + locationId,
                    'location_id': locationId
                });
                
                gtag('config', 'G-8FP0VQ2LC7', {
                    'custom_map': {'location_id': locationId}
                });
            }
            
            // Track in Meta Pixel
            if (typeof fbq !== 'undefined') {
                fbq('track', 'ViewContent', {
                    content_name: 'QR Landing Page',
                    content_category: 'QR Code',
                    location_id: locationId
                });
            }
            
            // Track in Microsoft Clarity
            if (typeof clarity !== 'undefined') {
                clarity('set', 'location_id', locationId);
            }
        });

        // Handle email signup success
        function handleSignupSuccess() {
            const signupSection = document.getElementById('signup-section');
            const donationSection = document.getElementById('donation-section');
            const thankYouMessage = document.getElementById('thank-you-message');
            
            if (!signupSection || !donationSection || !thankYouMessage) return;
            
            // Prevent duplicate triggers
            if (thankYouMessage.classList.contains('show')) return;
            
            // Show thank you message
            thankYouMessage.classList.add('show');
            
            // Scroll to thank you message
            thankYouMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // Track conversion
            const locationId = getLocationParam();
            
            if (typeof gtag !== 'undefined') {
                gtag('event', 'email_signup', {
                    'event_category': 'Conversion',
                    'event_label': 'Location ' + locationId,
                    'location_id': locationId
                });
            }
            
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Subscribe', {
                    location_id: locationId
                });
            }
            
            // Hide signup section and show donation section after a delay
            setTimeout(function() {
                signupSection.style.display = 'none';
                donationSection.classList.add('show');
                
                // Scroll to donation section
                donationSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 1500);
        }

        // Listen for postMessage events from GiveButter iframe
        window.addEventListener('message', function(event) {
            if (event.data && (
                event.data.type === 'givebutter:form:success' ||
                event.data.type === 'givebutter:success' ||
                (event.data.givebutter && event.data.givebutter.success)
            )) {
                handleSignupSuccess();
            }
        });

        // Poll for success indicators in the DOM (fallback method)
        let checkCount = 0;
        const maxChecks = 60;
        
        const checkSignupSuccess = setInterval(function() {
            checkCount++;
            
            const thankYouMessage = document.getElementById('thank-you-message');
            
            if (thankYouMessage && thankYouMessage.classList.contains('show')) {
                clearInterval(checkSignupSuccess);
                return;
            }
            
            const signupWidget = document.querySelector('givebutter-widget[id="j2GvyL"]');
            if (signupWidget) {
                const widgetContainer = signupWidget.closest('.qr-widget-section');
                if (widgetContainer) {
                    const successIndicators = widgetContainer.querySelectorAll(
                        '[class*="success"], [class*="thank"], [class*="complete"], [class*="submitted"], ' +
                        '[class*="done"], [id*="success"], [id*="thank"]'
                    );
                    
                    const widgetText = widgetContainer.textContent || '';
                    const successTexts = ['thank you', 'success', 'subscribed', 'you\'re in', 'you\'re all set'];
                    const hasSuccessText = successTexts.some(text => 
                        widgetText.toLowerCase().includes(text)
                    );
                    
                    if ((successIndicators.length > 0 || hasSuccessText) && widgetText.length > 50) {
                        handleSignupSuccess();
                        clearInterval(checkSignupSuccess);
                    }
                }
            }
            
            if (checkCount >= maxChecks) {
                clearInterval(checkSignupSuccess);
            }
        }, 500);

        // Listen for custom events
        document.addEventListener('givebutter:form:success', handleSignupSuccess);
        document.addEventListener('givebutter:success', handleSignupSuccess);
        
        // Expose function globally
        window.givebutterSignupSuccess = handleSignupSuccess;
        
        // Track donation interactions
        document.addEventListener('click', function(e) {
            if (e.target.closest('givebutter-widget[id="prm4Gg"]')) {
                const locationId = getLocationParam();
                
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'begin_checkout', {
                        'event_category': 'Donation',
                        'event_label': 'Location ' + locationId,
                        'location_id': locationId
                    });
                }
                
                if (typeof fbq !== 'undefined') {
                    fbq('track', 'InitiateCheckout', {
                        content_name: 'Bike Donation',
                        content_category: 'Donation',
                        location_id: locationId
                    });
                }
            }
        });
        
        // Track successful donations
        window.givebutterDonationSuccess = function(data) {
            const locationId = getLocationParam();
            
            if (typeof gtag !== 'undefined') {
                gtag('event', 'purchase', {
                    'transaction_id': data.id || 'unknown',
                    'value': data.amount || 0,
                    'currency': 'USD',
                    'event_category': 'Donation',
                    'event_label': 'Location ' + locationId,
                    'location_id': locationId
                });
            }
            
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Purchase', {
                    value: data.amount || 0,
                    currency: 'USD',
                    content_name: 'Bike Donation',
                    content_type: 'donation',
                    location_id: locationId
                });
            }
        };
    </script>
</body>

</html>
